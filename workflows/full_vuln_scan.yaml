# Full Vulnerability Assessment Workflow
# Comprehensive scan using SQLMap, SSLyze, Nuclei, and others

name: full_vuln_scan
description: Comprehensive vulnerability assessment including SQLi and SSL/TLS checks
version: 1.0.0
author: Guardian AI

steps:
  - name: web_discovery
    tool: httpx
    description: Identify live web endpoints
    args:
      tech_detect: true

  - name: ssl_analysis
    tool: sslyze
    description: Deep SSL/TLS configuration analysis
    dependencies:
      - web_discovery

  - name: fuzzing_paths
    tool: ffuf
    description: Fuzz for hidden directories and files
    args:
      wordlist: "common.txt"
      extensions: ".php,.html,.txt,.json"
    dependencies:
      - web_discovery

  - name: vuln_scanning
    tool: nuclei
    description: Template-based vulnerability scanning
    args:
      severity: "critical,high,medium"
    dependencies:
      - web_discovery

  - name: sql_injection_check
    tool: sqlmap
    description: Test for SQL injection vulnerabilities (Safe Mode)
    args:
      level: 1
      risk: 1
      batch: true
    dependencies:
      - fuzzing_paths
